{%- set pkg_dict = pkg or pkg_dict -%}

<div id="package-info">
    {% block package_info %}
        {%- call ui.util.call(ui.sidebar_section, title=h.dataset_display_name(pkg_dict)) -%}
            {% block nums %}
                {% set num_followers = h.follow_count('dataset', pkg_dict.id) %}

                {%- call ui.util.call(ui.table) -%}
                    {%- call ui.util.call(ui.table_head) -%}

                        {%- call ui.util.call(ui.table_row) -%}
                            {{ ui.table_cell(ui.link(_('Followers'), href=h.url_for(pkg_dict.type ~ ".followers", id=pkg_dict.name)), heading=true) }}
                            {{ ui.table_cell(h.SI_number_span(num_followers)) }}
                        {%- endcall %}


                        {%- call ui.util.call(ui.table_row) -%}
                            {{ ui.table_cell(_('Resources'), heading=true)  }}
                            {{ ui.table_cell(pkg_dict.resources|length) }}
                        {%- endcall %}

                        {%- call ui.util.call(ui.table_row) -%}
                            {{ ui.table_cell(ui.link(_('Groups'), href=h.url_for(pkg_dict.type ~ ".groups", id=pkg_dict.name)), heading=true)  }}
                            {{ ui.table_cell(pkg_dict.groups|length) }}
                        {%- endcall %}

                    {%- endcall %}
                {%- endcall %}

            {% endblock %}

            {% block follow_button %}
                {% if current_user.is_authenticated %}
                    {% if error_message %}
                        <div>{{ error_message }}</div>
                    {% endif %}

                    {%- with am_following=am_following, obj_type='dataset', obj_id=pkg_dict.id, anchor_type='package' -%}
                        {% include 'snippets/follow_button.html' %}
                    {%- endwith %}

                {% endif %}
            {% endblock %}

        {%- endcall %}
    {% endblock %}
</div>
