{%- call ui.util.call(ui.form, method="POST", id="organization-edit-form", enctype="multipart/form-data", attrs=kwargs) -%}
    {{ h.csrf_input() }}
    {%- if error_summary -%}
        {{ ui.form_errors(error_summary) }}
    {%- endif -%}

    {%- call ui.util.call(ui.form_block) -%}
        {%- set attrs = {"data-module": "slug-preview-target"} -%}
        {{ ui.input('title', id='field-title', label=_('Name'), placeholder=h.humanize_entity_type('organization', group_type, 'name placeholder') or _('My Organization'), value=data.title, errors=errors.title, attrs=attrs) }}

        {# Perhaps these should be moved into the controller? #}
        {% set prefix = h.url_for(group_type ~ '.read', id='') %}
        {% set domain = h.url_for(group_type ~ '.read', id='', qualified=true) %}
        {% set domain = domain|replace("http://", "")|replace("https://", "") %}
        {%- set attrs = {"data-module": "slug-preview-slug", "data-module-prefix": domain, "data-module-placeholder": "<" ~ group_type ~ ">"} -%}
        {% set url_attrs = {"data-module": "slug-preview-slug", "data-module-prefix": domain, "data-module-placeholder": '<' ~ group_type ~ '>'} %}
        {{ ui.input('name', id='field-url', label=_('URL'), value=data.name, errors=errors.name, placeholder=_('my-' ~ group_type), attrs=url_attrs, is_required=true) }}

        {{ ui.markdown('description', id='field-description', label=_('Description'), placeholder=h.humanize_entity_type('organization', group_type, 'description placeholder') or _('A little information about my organization...'), value=data.description, errors=errors.description) }}

        {% set is_upload = data.image_url and not data.image_url.startswith('http') %}
        {% set is_url = data.image_url and data.image_url.startswith('http') %}
        {{ ui.file_input('image_upload', label=_('Image'), value=data.image_url, errors=errors.image_url, is_url=is_url, is_upload=is_upload) }}

    {%- endcall -%}

    {%- call ui.util.call(ui.form_block) -%}
        {%- for extra in (data.extras or [])[:3] -%}
            {%- if extra -%}
                {{ ui.extra_field(extra, errors) }}
            {%- endif -%}
        {%- endfor -%}
        {%- if (data.extras or [])|length < 3 -%}
            {{ ui.extra_field_multiplicator() }}
        {%- endif -%}
    {%- endcall -%}

    {{ ui.hidden_input('save', value=_('Save Organization')) }}

    {%- call ui.util.call(ui.form_actions) -%}
        {%- if h.check_access('organization_delete', {'id': data.id}) -%}
            {%- set modal_id = ui.util.id() -%}
            {{ ui.confirm_modal(h.humanize_entity_type('organization', group_type, 'delete confirmation') or _('Are you sure you want to delete this Organization? Note*: Deleting cannot be performed while public or private datasets belong to this organization.'), id=modal_id, href=h.url_for(group_type ~ '.delete', id=data.id)) }}
            {{ ui.modal_handle(_('Delete'), id=modal_id, style="danger") }}
        {%- endif -%}

        {{ ui.submit(h.humanize_entity_type('organization', group_type, 'save label') or _('Save Organization'), name="save", type="submit", style="primary") }}
    {%- endcall -%}
{%- endcall -%}
