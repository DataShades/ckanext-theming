{%- macro organization_item(group) -%}
    {%- do kwargs -%}
    {{ ui.group_item(group, **kwargs) }}
{%- endmacro %}

{%- macro group_item(group) -%}
    {%- do kwargs -%}
    {% set img = group.image_display_url or h.url_for_static('/base/images/placeholder-' ~ ('organization' if group.is_organization else 'group') ~ '.png') %}
    {% set title = group.title or group.name  %}
    {% set body = h.markdown_extract(group.description, 120)|urlize %}

    {{ ui.card(title=title, img=img, body=body, href=h.url_for(('organization' if group.is_organization else 'group') ~ ".read", id=group.name)) }}
{%- endmacro %}


{%- macro package_item(pkg) -%}
    {%- do kwargs -%}
    {% set title = pkg.title or pkg.name  %}
    {% set body = h.markdown_extract(pkg.notes, 120)|urlize %}

    {{ ui.card(title=title, body=body, href=h.url_for(pkg.type ~ ".read", id=pkg.name)) }}
{%- endmacro %}

{%- macro resource_item(res) -%}
    {%- do kwargs -%}
    {% set title = res.name  %}
    {% set body = h.markdown_extract(res.description, 120)|urlize %}

    {{ ui.card(title=title, body=body, href=h.url_for("resource.read", id=res.package_id, resource_id=res.id)) }}
{%- endmacro %}


{%- macro search_form(query, sorting, sorting_options, query_error, item_count, first_item_position, last_item_position, facets, facet_titles, active_filters, query_name="q", sorting_name="sort" ) -%}
    {%- call ui.util.call(ui.form, **kwargs) -%}
        {%- include "macros/ui/snippets/search_form.html" -%}
    {%- endcall %}
{%- endmacro %}

{%- macro facet_item(key, value, label, count, active) -%}
    {% set url = h.remove_url_param(key, value) if active else h.add_url_param(new_params={key: value}) %}

    {%- call ui.util.call(ui.link, href=url) -%}
        <div style="display: flex; justify-content: space-between;">
            <span>{{ label }}</span>
            <span>{{ "&times;"|safe if active else count }}</span>
        </div>
    {%- endcall %}

{%- endmacro %}

{%- macro facet_group(content, title) -%}
    {%- call ui.util.call(ui.section) -%}
        {{ ui.heading(title, level=3) }}
        {{ content }}
        {{ ui.divider() }}
    {%- endcall %}
{%- endmacro %}

{%- macro activity_stream(content) -%}
    {{ ui.listing(content) }}
{%- endmacro %}


{%- macro activity_item(content, activity) -%}
    <div>
        {{ content }}
    </div>
{%- endmacro %}
